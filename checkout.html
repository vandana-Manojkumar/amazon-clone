

<!DOCTYPE html>
<html>
<head>
  <title>Checkout</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/shared/general.css">
  <link rel="stylesheet" href="styles/pages/checkout/checkout-header.css">
  <link rel="stylesheet" href="styles/pages/checkout/checkout.css">
</head>
<body>
  <div class="checkout-header">
    <div class="header-content">
      <div class="checkout-header-left-section">
        <a href="amazon.html">
          <img class="amazon-logo" src="images/amazon-logo.png">
          <img class="amazon-mobile-logo" src="images/amazon-mobile-logo.png">
        </a>
      </div>
      <div class="checkout-header-middle-section">
        Checkout (<a class="return-to-home-link" href="amazon.html"><span class="item-count">0</span> items</a>)
      </div>
      <div class="checkout-header-right-section">
        <img src="images/icons/checkout-lock-icon.png">
      </div>
    </div>
  </div>

  <div class="main">
    <div class="page-title">Review your order</div>
    <div class="checkout-grid">
      <div class="order-summary"></div>
      <div class="payment-summary">
        <div class="payment-summary-title">Order Summary</div>
        <div class="payment-summary-row items-row">
          <div>Items:</div>
          <div class="payment-summary-money items-cost"></div>
        </div>
        <div class="payment-summary-row shipping-row">
          <div>Shipping & handling:</div>
          <div class="payment-summary-money">$4.99</div>
        </div>
        <div class="payment-summary-row subtotal-row">
          <div>Total before tax:</div>
          <div class="payment-summary-money total-before-tax"></div>
        </div>
        <div class="payment-summary-row tax-row">
          <div>Estimated tax (10%):</div>
          <div class="payment-summary-money estimated-tax"></div>
        </div>
        <div class="payment-summary-row total-row">
          <div>Order total:</div>
          <div class="payment-summary-money order-total"></div>
        </div>
        <button class="place-order-button button-primary">Place your order</button>
      </div>
    </div>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', () => {
  const cart = JSON.parse(localStorage.getItem('cart')) || [];
  const orderSummary = document.querySelector('.order-summary');
  const paymentSummaryItems = document.querySelector('.items-cost');
  const paymentSummaryTotalBeforeTax = document.querySelector('.total-before-tax');
  const paymentSummaryEstimatedTax = document.querySelector('.estimated-tax');
  const paymentSummaryOrderTotal = document.querySelector('.order-total');
  const itemCount = document.querySelector('.item-count');
  const totalItemsDisplay = document.querySelector('.total-items'); // Assuming you have a total items display element
  const placeOrderButton = document.querySelector('.place-order-button');

  let totalBeforeTax = 0;

  const updateCartDisplay = () => {
    orderSummary.innerHTML = ''; // Clear existing items
    totalBeforeTax = 0;
    let totalItems = 0;

    cart.forEach((product, index) => {
      const cartItemContainer = document.createElement('div');
      cartItemContainer.className = 'cart-item-container';

      cartItemContainer.innerHTML = `
        <div class="cart-item-details-grid">
          <img class="product-image" src="${product.image}">
          <div class="cart-item-details">
            <div class="product-name">${product.name}</div>
            <div class="product-price">$${(product.price * product.quantity).toFixed(2)}</div>
            <div class="product-quantity">
              <span>
                Quantity: <span class="quantity-label">${product.quantity}</span>
              </span>
              <span class="update-quantity-link link-primary" data-index="${index}">
                Update
              </span>
              <span class="delete-quantity-link link-primary" data-index="${index}">
                Delete
              </span>
            </div>
          </div>
        </div>
      `;

      orderSummary.appendChild(cartItemContainer);

      totalBeforeTax += product.price * product.quantity;
      totalItems += product.quantity;
    });

    const estimatedTax = totalBeforeTax * 0.1;
    const orderTotal = totalBeforeTax > 0 ? totalBeforeTax + estimatedTax + 4.99 : 0; // Add shipping cost

    paymentSummaryItems.innerText = `$${totalBeforeTax.toFixed(2)}`;
    paymentSummaryTotalBeforeTax.innerText = `$${(totalBeforeTax + 4.99).toFixed(2)}`;
    paymentSummaryEstimatedTax.innerText = `$${estimatedTax.toFixed(2)}`;
    paymentSummaryOrderTotal.innerText = `$${orderTotal.toFixed(2)}`;

    // Calculate sum of individual digits
    const sumOfDigits = getSumOfDigits(totalItems);

    // Update item count display
    itemCount.innerHTML = `${sumOfDigits} items`;

    // Display total items count
    totalItemsDisplay.innerText = totalItems; // Assuming you have a total items display element
  };

  // Function to calculate sum of digits
  const getSumOfDigits = (number) => {
    let sum = 0;
    const digits = number.toString().split('');
    digits.forEach((digit) => {
      sum += parseInt(digit);
    });
    return sum;
  };

  // Handle delete
  orderSummary.addEventListener('click', (e) => {
    if (e.target.classList.contains('delete-quantity-link')) {
      const index = e.target.getAttribute('data-index');
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartDisplay();
    }
  });

  // Handle update
  orderSummary.addEventListener('click', (e) => {
    if (e.target.classList.contains('update-quantity-link')) {
      const index = e.target.getAttribute('data-index');
      const newQuantity = prompt('Enter new quantity:', cart[index].quantity);
      if (newQuantity && !isNaN(newQuantity) && newQuantity > 0) {
        cart[index].quantity = parseInt(newQuantity);
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
      }
    }
  });

  // Handle place order
  placeOrderButton.addEventListener('click', () => {
    if (cart.length === 0) {
      alert('Your cart is empty. Please add items to your cart before placing an order.');
      return;
    }

    const orders = JSON.parse(localStorage.getItem('orders')) || [];
    const newOrder = {
      id: Date.now(),
      date: new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric' }),
      total: (totalBeforeTax + 4.99 + (totalBeforeTax * 0.1)).toFixed(2),
      items: cart
    };
    orders.push(newOrder);
    localStorage.setItem('orders', JSON.stringify(orders));
    localStorage.removeItem('cart');
    window.location.href = 'orders.html';
  });

  updateCartDisplay();
});



  </script>
</body>
</html>
